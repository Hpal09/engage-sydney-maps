"use client";

import { useState } from 'react';
import { MapPin, Info, Link, Calendar, Tag, View, MessageSquare } from 'lucide-react';
import type { Business } from '@/types';
import type { Deal, Event } from '@/lib/dataService';
import { formatEventCategory } from '@/lib/categories';
import FeedbackOverlay from './FeedbackOverlay';

interface Props {
  location: Business | null;
  deals?: Deal[];
  events?: Event[];
  onClose: () => void;
  onSetStart: () => void;
  onSetDestination: () => void;
  onTakeMeThere: (business: Business) => void;
  onOpenIndoorMap?: (placeId: string) => void;
}

export default function LocationDetailModal({ location, deals = [], events = [], onClose, onSetStart, onSetDestination, onTakeMeThere, onOpenIndoorMap }: Props) {
  const [showFeedback, setShowFeedback] = useState(false);

  if (!location) return null;

  // Check if this location has indoor navigation available
  const hasIndoorNav = location.hasIndoorMap === true;

  const handleShare = async () => {
    // Generate shareable URL with POI ID
    const url = new URL(window.location.href);
    url.searchParams.set('poi', location.id);
    const shareUrl = url.toString();

    const shareData = {
      title: location.name,
      text: `Check out ${location.name} - ${location.category}`,
      url: shareUrl,
    };

    try {
      // Try Web Share API first (works on mobile)
      if (navigator.share) {
        await navigator.share(shareData);
      } else {
        // Fallback to clipboard copy
        await navigator.clipboard.writeText(shareUrl);
      }
    } catch (error) {
      // If sharing was cancelled or failed, try clipboard as last resort
      if (error instanceof Error && error.name !== 'AbortError') {
        try {
          await navigator.clipboard.writeText(shareUrl);
        } catch (clipboardError) {
          // Silently fail - user will know sharing didn't work
        }
      }
    }
  };

  return (
    <div
      className="pointer-events-auto fixed inset-0 z-50 flex items-end justify-center bg-black/40 px-2.5"
      onClick={onClose}
      style={{ touchAction: 'none' }}
    >
      <div
        className="w-full rounded-t-3xl bg-white shadow-2xl flex flex-col"
        style={{ maxWidth: '400px', maxHeight: '90vh', touchAction: 'auto', fontFamily: 'Figtree, sans-serif' }}
        onClick={(e) => e.stopPropagation()}
      >
          {/* Handle bar - clickable to close */}
          <button
            type="button"
            onClick={(e) => {
              e.stopPropagation();
              onClose();
            }}
            className="flex justify-center pt-3 pb-2 w-full cursor-pointer hover:opacity-70 transition-opacity"
            aria-label="Close"
            style={{ touchAction: 'manipulation' }}
          >
            <div className="h-1.5 w-10 rounded-full bg-gray-300"></div>
          </button>

        {/* Header */}
        <div className="flex items-start justify-between p-5 pb-3 pt-1 flex-shrink-0">
          <div className="flex-1">
            <div className="flex items-center gap-3">
              <h2 className="text-2xl font-bold text-gray-900">{location.name}</h2>
              {/* Show clickable icons if location has events or deals */}
              <div className="flex items-center gap-2" style={{ marginLeft: '4px' }}>
                {events.length > 0 && (
                  <button
                    onClick={(e) => {
                      e.stopPropagation();
                      const eventsSection = document.getElementById('events-section');
                      if (eventsSection) {
                        eventsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                      }
                    }}
                    className="flex items-center hover:opacity-70 active:opacity-50 transition-opacity"
                    style={{ touchAction: 'manipulation' }}
                    aria-label="Scroll to events"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="17" viewBox="0 0 20 17" fill="none" style={{ flexShrink: 0 }}>
                      <path fillRule="evenodd" clipRule="evenodd" d="M2.45452 4.34084L8.36358 0.260347C8.68081 0.0413522 9.07325 -0.0444243 9.4546 0.02188C9.83595 0.0881844 10.175 0.301141 10.3972 0.61392L11.3292 1.92632C11.3429 1.94552 11.3559 1.96508 11.3683 1.985L2.45452 4.34084ZM0.453797 9.07302L0.0496372 7.58528C-0.0504798 7.2163 0.00213118 6.82321 0.195897 6.49248C0.389662 6.16175 0.70871 5.92048 1.08286 5.82174L15.894 1.90795C16.2681 1.80908 16.6667 1.86082 17.0021 2.05177C17.3376 2.24272 17.5823 2.55726 17.6826 2.92619L18.1028 4.4737C18.1622 4.69217 18.155 4.92304 18.0823 5.13753C18.0095 5.35202 17.8743 5.54064 17.6936 5.67988C17.4095 5.89835 17.1974 6.19479 17.0838 6.5319C16.9702 6.86901 16.9602 7.23173 17.0552 7.5744C17.1501 7.91707 17.3458 8.22439 17.6174 8.45768C17.8891 8.69096 18.2246 8.83979 18.5818 8.88544C18.8025 8.91383 19.0096 9.00613 19.177 9.15066C19.3444 9.29519 19.4646 9.48545 19.5223 9.69736L19.9502 11.2733C20.0505 11.6422 19.998 12.0353 19.8044 12.3661C19.6108 12.6969 19.2918 12.9383 18.9177 13.0372L4.10584 16.951C3.73179 17.0498 3.33328 16.998 2.99794 16.807C2.6626 16.6161 2.41789 16.3016 2.31761 15.9328L1.91491 14.4501C1.85126 14.2167 1.85737 13.9702 1.93251 13.7403C2.00765 13.5103 2.14861 13.3067 2.33842 13.1539C2.61115 12.9343 2.8137 12.6417 2.92168 12.3112C3.02966 11.9808 3.03846 11.6266 2.94702 11.2913C2.85559 10.956 2.66781 10.654 2.40631 10.4215C2.14482 10.189 1.82075 10.0361 1.47314 9.98108C1.23267 9.94282 1.00855 9.83682 0.827757 9.67584C0.646968 9.51486 0.517228 9.30577 0.454162 9.07374M13.407 6.66534C13.5476 6.63013 13.6797 6.56773 13.7956 6.48177C13.9115 6.3958 14.009 6.28799 14.0823 6.16458C14.1556 6.04118 14.2034 5.90463 14.2228 5.76288C14.2422 5.62113 14.2328 5.47699 14.1953 5.33882C14.1578 5.20066 14.0928 5.07123 14.0041 4.95804C13.9154 4.84484 13.8048 4.75015 13.6787 4.67945C13.5526 4.60875 13.4136 4.56344 13.2696 4.54617C13.1256 4.5289 12.9796 4.54 12.84 4.57883C12.5628 4.65594 12.3276 4.83761 12.1852 5.08452C12.0429 5.33142 12.0048 5.62369 12.0794 5.89804C12.1539 6.17238 12.3351 6.40673 12.5835 6.55034C12.832 6.69395 13.1279 6.73527 13.407 6.66534ZM14.1627 9.44784C14.3017 9.41115 14.4319 9.34783 14.5461 9.26149C14.6602 9.17515 14.756 9.06749 14.8279 8.94466C14.8999 8.82182 14.9466 8.68621 14.9654 8.54558C14.9842 8.40494 14.9747 8.26203 14.9375 8.125C14.9003 7.98798 14.8361 7.85952 14.7485 7.74696C14.661 7.63441 14.5518 7.53996 14.4272 7.46902C14.3027 7.39807 14.1652 7.35201 14.0226 7.33347C13.88 7.31493 13.7351 7.32428 13.5961 7.36097C13.3155 7.43512 13.0763 7.61616 12.931 7.86428C12.7857 8.11239 12.7464 8.40725 12.8216 8.68399C12.8968 8.96072 13.0803 9.19667 13.3319 9.33992C13.5835 9.48317 13.8821 9.52199 14.1627 9.44784ZM14.9192 12.23C15.0602 12.1951 15.1927 12.133 15.309 12.0471C15.4254 11.9613 15.5233 11.8534 15.5969 11.7299C15.6706 11.6064 15.7186 11.4697 15.7382 11.3277C15.7578 11.1856 15.7485 11.0412 15.7109 10.9028C15.6733 10.7644 15.6081 10.6347 15.5192 10.5213C15.4303 10.408 15.3194 10.3132 15.193 10.2426C15.0666 10.1719 14.9272 10.1267 14.7829 10.1097C14.6386 10.0927 14.4923 10.1042 14.3526 10.1435C14.0762 10.2212 13.8418 10.403 13.7 10.6496C13.5583 10.8962 13.5205 11.1878 13.5949 11.4617C13.6692 11.7355 13.8498 11.9695 14.0975 12.1132C14.3453 12.257 14.6404 12.2989 14.9192 12.23Z" fill="#0096FA"/>
                    </svg>
                  </button>
                )}
                {deals.length > 0 && (
                  <button
                    onClick={(e) => {
                      e.stopPropagation();
                      const dealsSection = document.getElementById('deals-section');
                      if (dealsSection) {
                        dealsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                      }
                    }}
                    className="flex items-center hover:opacity-70 active:opacity-50 transition-opacity"
                    style={{ touchAction: 'manipulation' }}
                    aria-label="Scroll to deals"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 17 17" fill="none" style={{ flexShrink: 0 }}>
                      <path d="M11.0734 10.0863C11.0837 10.1774 11.0742 10.2697 11.0455 10.3567C11.0167 10.4438 10.9695 10.5236 10.9069 10.5907C10.8444 10.6578 10.768 10.7105 10.6832 10.7452C10.5983 10.78 10.5069 10.7959 10.4153 10.7919C10.3246 10.7953 10.2343 10.7788 10.1507 10.7435C10.0671 10.7083 9.99213 10.6552 9.93118 10.588C9.87022 10.5208 9.82469 10.441 9.79779 10.3544C9.77089 10.2677 9.76326 10.1762 9.77543 10.0863C9.76284 9.99529 9.77004 9.90266 9.79653 9.81471C9.82302 9.72677 9.86818 9.64558 9.92893 9.57669C9.98968 9.5078 10.0646 9.45284 10.1485 9.41556C10.2325 9.37828 10.3235 9.35955 10.4153 9.36067C10.5083 9.35821 10.6007 9.37586 10.6862 9.41241C10.7718 9.44896 10.8484 9.50355 10.9109 9.57244C10.9733 9.64134 11.0202 9.72292 11.0483 9.8116C11.0763 9.90028 11.0849 9.99397 11.0734 10.0863Z" fill="#0096FA"/>
                      <path d="M6.81854 5.97692C6.72677 5.97593 6.63587 5.99474 6.55203 6.03208C6.4682 6.06942 6.3934 6.1244 6.33274 6.19327C6.27209 6.26214 6.22701 6.34329 6.20056 6.43117C6.17412 6.51905 6.16695 6.61161 6.17953 6.70251C6.16737 6.79236 6.17498 6.88379 6.20183 6.97039C6.22868 7.057 6.27413 7.13669 6.33499 7.2039C6.39585 7.27111 6.47066 7.32422 6.55418 7.3595C6.6377 7.39479 6.72792 7.41141 6.81854 7.40819C6.90976 7.41056 7.00044 7.39354 7.0846 7.35827C7.16876 7.323 7.24447 7.27028 7.30675 7.20359C7.36903 7.13689 7.41644 7.05774 7.44587 6.97137C7.4753 6.88499 7.48606 6.79336 7.47746 6.70251C7.48723 6.61047 7.47743 6.51739 7.44868 6.42941C7.41994 6.34142 7.37291 6.26051 7.31068 6.19198C7.24845 6.12346 7.17243 6.06887 7.08762 6.03181C7.0028 5.99474 6.9111 5.97604 6.81854 5.97692ZM6.81854 5.97692C6.72677 5.97593 6.63587 5.99474 6.55203 6.03208C6.4682 6.06942 6.3934 6.1244 6.33274 6.19327C6.27209 6.26214 6.22701 6.34329 6.20056 6.43117C6.17412 6.51905 6.16695 6.61161 6.17953 6.70251C6.16737 6.79236 6.17498 6.88379 6.20183 6.97039C6.22868 7.057 6.27413 7.13669 6.33499 7.2039C6.39585 7.27111 6.47066 7.32422 6.55418 7.3595C6.6377 7.39479 6.72792 7.41141 6.81854 7.40819C6.90976 7.41056 7.00044 7.39354 7.0846 7.35827C7.16876 7.323 7.24447 7.27028 7.30675 7.20359C7.36903 7.13689 7.41644 7.05774 7.44587 6.97137C7.4753 6.88499 7.48606 6.79336 7.47746 6.70251C7.48723 6.61047 7.47743 6.51739 7.44868 6.42941C7.41994 6.34142 7.37291 6.26051 7.31068 6.19198C7.24845 6.12346 7.17243 6.06887 7.08762 6.03181C7.0028 5.99474 6.9111 5.97604 6.81854 5.97692ZM16.8037 9.00744L8.61953 0.819847C8.50598 0.705835 8.35561 0.63587 8.19526 0.62243L0.736724 0.00247279C0.638174 -0.00596179 0.538971 0.00724137 0.446058 0.0411583C0.353145 0.0750752 0.268766 0.128887 0.198826 0.198826C0.128887 0.268766 0.0750752 0.353145 0.0411583 0.446058C0.00724137 0.538971 -0.00596179 0.638174 0.00247279 0.736724L0.623296 8.19613C0.636101 8.35697 0.705782 8.508 0.819847 8.62213L9.00051 16.8002C9.06358 16.8635 9.13854 16.9138 9.22108 16.9481C9.30362 16.9823 9.39212 17 9.4815 17C9.57088 17 9.65938 16.9823 9.74192 16.9481C9.82446 16.9138 9.89941 16.8635 9.96248 16.8002L16.8028 9.95989C16.8661 9.89681 16.9164 9.82186 16.9507 9.73932C16.9849 9.65678 17.0026 9.56828 17.0026 9.4789C17.0026 9.38952 16.9849 9.30102 16.9507 9.21848C16.9164 9.13594 16.8661 9.06098 16.8028 8.99791L16.8037 9.00744ZM3.09273 4.29455C2.87511 4.29455 2.66237 4.23003 2.48141 4.10914C2.30045 3.98825 2.1594 3.81643 2.07608 3.61539C1.99276 3.41435 1.97091 3.19311 2.01331 2.97966C2.0557 2.7662 2.16043 2.57011 2.31425 2.41617C2.46807 2.26222 2.66408 2.15734 2.87751 2.11478C3.09093 2.07222 3.31217 2.09389 3.51328 2.17705C3.71439 2.26021 3.88632 2.40114 4.00735 2.582C4.12838 2.76286 4.19307 2.97555 4.19324 3.19317C4.19336 3.33777 4.16498 3.48097 4.10972 3.61459C4.05447 3.74821 3.97342 3.86963 3.87122 3.97191C3.76902 4.0742 3.64766 4.15534 3.51408 4.2107C3.3805 4.26606 3.23733 4.29455 3.09273 4.29455ZM5.1708 6.69818C5.16538 6.48234 5.20463 6.26772 5.2861 6.06777C5.36757 5.86782 5.48949 5.68688 5.64422 5.5363C5.79895 5.38572 5.98314 5.26875 6.18523 5.19274C6.38731 5.11673 6.60293 5.08332 6.81854 5.09461C7.03582 5.0824 7.2533 5.1149 7.45752 5.19012C7.66173 5.26533 7.84834 5.38165 8.0058 5.53189C8.16325 5.68212 8.28821 5.86306 8.37292 6.06352C8.45764 6.26399 8.50031 6.4797 8.49831 6.69732C8.50167 6.91451 8.45976 7.13003 8.37526 7.33014C8.29076 7.53026 8.16551 7.71058 8.0075 7.85963C7.84948 8.00869 7.66216 8.12321 7.45746 8.1959C7.25276 8.26859 7.03517 8.29786 6.81854 8.28185C6.60357 8.29652 6.38791 8.26611 6.18539 8.19257C5.98286 8.11903 5.79794 8.00398 5.64247 7.85479C5.48701 7.70561 5.36444 7.52558 5.28262 7.32625C5.2008 7.12693 5.16153 6.9127 5.16734 6.69732L5.1708 6.69818ZM6.19252 11.5548L10.2569 5.18985H11.0855L7.01076 11.5539L6.19252 11.5548ZM10.4197 11.6682C10.2073 11.6732 9.99601 11.6356 9.79833 11.5578C9.60065 11.4799 9.42053 11.3633 9.26856 11.2148C9.11658 11.0664 8.99582 10.889 8.91338 10.6932C8.83093 10.4974 8.78846 10.2871 8.78846 10.0746C8.78846 9.86215 8.83093 9.65184 8.91338 9.45602C8.99582 9.26021 9.11658 9.08286 9.26856 8.93439C9.42053 8.78592 9.60065 8.66933 9.79833 8.59146C9.99601 8.5136 10.2073 8.47604 10.4197 8.48099C10.6363 8.46936 10.853 8.50234 11.0564 8.57789C11.2598 8.65344 11.4455 8.76996 11.602 8.92022C11.7585 9.07048 11.8825 9.25128 11.9663 9.45141C12.0501 9.65155 12.0918 9.86676 12.089 10.0837C12.0933 10.3004 12.0524 10.5157 11.9688 10.7157C11.8852 10.9157 11.7608 11.0961 11.6035 11.2453C11.4462 11.3945 11.2595 11.5093 11.0554 11.5822C10.8513 11.6552 10.6341 11.6848 10.4179 11.6691L10.4197 11.6682ZM7.47746 6.69645C7.48898 6.60408 7.48039 6.51032 7.45229 6.42157C7.4242 6.33283 7.37725 6.25121 7.31467 6.1823C7.25209 6.11339 7.17536 6.05882 7.08973 6.02232C7.0041 5.98583 6.91159 5.96827 6.81854 5.97086C6.44708 5.97086 6.17953 6.21936 6.17953 6.69645C6.16737 6.7863 6.17498 6.87773 6.20183 6.96433C6.22868 7.05094 6.27413 7.13063 6.33499 7.19784C6.39585 7.26505 6.47066 7.31816 6.55418 7.35344C6.6377 7.38873 6.72792 7.40535 6.81854 7.40213C6.90961 7.40436 7.00011 7.38727 7.0841 7.352C7.16809 7.31673 7.24365 7.26406 7.30582 7.19748C7.36799 7.1309 7.41535 7.0519 7.44478 6.96569C7.47422 6.87948 7.48506 6.78802 7.47659 6.69732L7.47746 6.69645Z" fill="#0096FA"/>
                    </svg>
                  </button>
                )}
              </div>
            </div>
            <div className="mt-1 text-sm text-gray-600">{location.category}</div>
          </div>

          {/* Share Button */}
          <button
            onClick={(e) => {
              e.stopPropagation();
              handleShare();
            }}
            className="flex items-center justify-center hover:opacity-90 active:opacity-80 transition-opacity flex-shrink-0"
            style={{
              width: '45px',
              height: '45px',
              borderRadius: '50%',
              backgroundColor: 'white',
              border: '1px solid #E0E0E0',
              boxShadow: '0 2px 8px rgba(0, 0, 0, 0.1)',
              touchAction: 'manipulation'
            }}
            aria-label="Share location"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path fillRule="evenodd" clipRule="evenodd" d="M18.0764 16.5445C21.5575 16.5445 23.3133 20.5588 20.8486 22.8971C17.9672 25.632 13.1512 22.8581 14.3223 19.1861L6.628 14.686C4.13938 16.9412 0 15.2593 0 11.9942C0 8.73006 4.14035 7.04696 6.628 9.3024L14.3234 4.80126C13.5635 2.4217 15.4395 0 18.0764 0C21.5575 0 23.3133 4.01429 20.8486 6.35258C19.3407 7.7838 16.9042 7.8095 15.3637 6.40806L7.6716 10.9082C7.89784 11.613 7.89784 12.3753 7.6716 13.0802L15.3637 17.5792C16.0684 16.9381 17.0242 16.5445 18.0764 16.5445Z" fill="#707070"/>
            </svg>
          </button>
        </div>

        {/* Action Buttons */}
        <div className="space-y-3 px-5 pb-4 flex-shrink-0">
          {/* Primary Action: Take me there */}
          <button
            onClick={(e) => {
              e.stopPropagation();
              onTakeMeThere(location);
            }}
            className="w-full text-white shadow-lg hover:opacity-90 active:opacity-80 transition-opacity flex items-center justify-center gap-2"
            style={{
              touchAction: 'manipulation',
              height: '34px',
              borderRadius: '36px',
              border: '0 solid #BABABA',
              background: '#0096FA',
              fontFamily: 'Figtree, sans-serif',
              fontSize: '14px',
              fontWeight: 500,
              color: '#FFFFFF',
              textAlign: 'center',
              lineHeight: 'normal'
            }}
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="8" height="13" viewBox="0 0 8 13" fill="none">
              <g clipPath="url(#clip0_51_316)">
                <path d="M4.00021 0C5.06102 0 6.07838 0.432377 6.82849 1.20201C7.57859 1.97165 8 3.0155 8 4.10392C8 6.37115 3.99979 13 3.99979 13C3.99979 13 0 6.37072 0 4.10436C0 3.01581 0.421449 1.97185 1.17163 1.20214C1.92182 0.432422 2.93929 0 4.00021 0Z" fill="white"/>
                <path d="M4.02749 5.62905C4.97601 5.62905 5.74493 4.84011 5.74493 3.8669C5.74493 2.89369 4.97601 2.10475 4.02749 2.10475C3.07898 2.10475 2.31006 2.89369 2.31006 3.8669C2.31006 4.84011 3.07898 5.62905 4.02749 5.62905Z" fill="#0096FA"/>
              </g>
              <defs>
                <clipPath id="clip0_51_316">
                  <rect width="8" height="13" fill="white"/>
                </clipPath>
              </defs>
            </svg>
            <span>Take me there</span>
          </button>

          {/* Secondary Actions */}
          <div className="flex gap-3">
            <button
              onClick={(e) => {
                e.stopPropagation();
                onSetStart();
              }}
              className="flex-1 rounded-full border border-[#BDBDBD] bg-white px-4 py-1.5 hover:bg-gray-50 active:bg-gray-100"
              style={{
                touchAction: 'manipulation',
                color: '#707070',
                textAlign: 'center',
                fontFamily: 'Figtree',
                fontSize: '14px',
                fontStyle: 'normal',
                fontWeight: 500,
                lineHeight: 'normal'
              }}
            >
              <div className="flex items-center justify-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="11px" height="11px" viewBox="0 0 11 11" fill="none">
                  <circle cx="5.5" cy="5.5" r="2.5" fill="#0096FA"/>
                  <circle cx="5.5" cy="5.5" r="5.25" stroke="#0096FA" strokeWidth="0.5"/>
                </svg>
                Set as start point
              </div>
            </button>
            <button
              onClick={(e) => {
                e.stopPropagation();
                onSetDestination();
              }}
              className="flex-1 rounded-full border border-[#BDBDBD] bg-white px-4 py-1.5 hover:bg-gray-50 active:bg-gray-100"
              style={{
                touchAction: 'manipulation',
                color: '#707070',
                textAlign: 'center',
                fontFamily: 'Figtree',
                fontSize: '14px',
                fontStyle: 'normal',
                fontWeight: 500,
                lineHeight: 'normal'
              }}
            >
              <div className="flex items-center justify-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="8" height="13" viewBox="0 0 8 13" fill="none">
                  <g clipPath="url(#clip0_51_355)">
                    <path d="M4.00021 0C5.06102 0 6.07838 0.432377 6.82849 1.20201C7.57859 1.97165 8 3.0155 8 4.10392C8 6.37115 3.99979 13 3.99979 13C3.99979 13 0 6.37072 0 4.10436C0 3.01581 0.421449 1.97185 1.17163 1.20214C1.92182 0.432422 2.93929 0 4.00021 0Z" fill="#0096FA"/>
                    <path d="M4.02749 5.62905C4.97601 5.62905 5.74493 4.84011 5.74493 3.8669C5.74493 2.89369 4.97601 2.10475 4.02749 2.10475C3.07898 2.10475 2.31006 2.89369 2.31006 3.8669C2.31006 4.84011 3.07898 5.62905 4.02749 5.62905Z" fill="white"/>
                  </g>
                  <defs>
                    <clipPath id="clip0_51_355">
                      <rect width="8" height="13" fill="white"/>
                    </clipPath>
                  </defs>
                </svg>
                Set as destination
              </div>
            </button>
          </div>
        </div>

        {/* Content */}
        <div
          className="flex-1 min-h-0 overflow-y-auto pb-5"
          style={{
            scrollbarWidth: 'thin',
            scrollbarColor: '#C5C5C5 transparent'
          } as React.CSSProperties}
        >
          <div className="px-5">
            {/* Image */}
            <div className="mb-4 overflow-hidden rounded-2xl bg-gradient-to-br from-blue-100 to-blue-200">
            {location.imageUrl ? (
              <div className="h-48 w-full">
                <img
                  src={location.imageUrl}
                  alt={location.name}
                  className="h-full w-full object-cover"
                />
              </div>
            ) : (
              <div className="flex h-48 items-center justify-center text-gray-400">
                <div className="text-center">
                  <div className="text-6xl">üèõÔ∏è</div>
                  <div className="mt-2 text-sm">{location.name}</div>
                </div>
              </div>
            )}
          </div>

          {/* Overview Section */}
          <div className="mb-5">
            <div className="mb-2 flex items-center gap-2 text-lg font-semibold text-gray-900">
              <svg xmlns="http://www.w3.org/2000/svg" width="18.099" height="18" viewBox="0 0 19 18" fill="none">
                <path d="M9.04967 17.2286C13.6192 17.2286 17.3236 13.5445 17.3236 9C17.3236 4.45548 13.6192 0.771423 9.04967 0.771423C4.48011 0.771423 0.775757 4.45548 0.775757 9C0.775757 13.5445 4.48011 17.2286 9.04967 17.2286Z" fill="#0096FA"/>
                <path d="M9.04959 18C14.0475 18 18.0992 13.9706 18.0992 9C18.0992 4.02944 14.0475 0 9.04959 0C4.05164 0 0 4.02944 0 9C0 13.9706 4.05164 18 9.04959 18Z" fill="#0096FA"/>
                <path d="M9.04956 8.11856V13.9958" stroke="white" strokeWidth="1.5" strokeLinecap="round"/>
                <path d="M9.04957 6.35556C9.70244 6.35556 10.2317 5.8292 10.2317 5.1799C10.2317 4.5306 9.70244 4.00424 9.04957 4.00424C8.39669 4.00424 7.86743 4.5306 7.86743 5.1799C7.86743 5.8292 8.39669 6.35556 9.04957 6.35556Z" fill="white"/>
              </svg>
              Overview
            </div>
            <p className="text-gray-700">
              {location.description || 'A vibrant hub for campus life, offering dining, meeting spaces, event venues, and recreational areas for students and faculty.'}
            </p>
          </div>

          {/* Hours & Info */}
          <div className="p-4 mb-5" style={{ borderRadius: '8px', background: '#F4F4F4' }}>
            <div className="space-y-3">
              {/* Row 1: Address */}
              <div>
                <div className="font-medium text-gray-900 text-sm">Address</div>
                <div className="text-gray-600 text-sm">{location.address || '455 George St, Sydney NSW 2000'}</div>
              </div>

              {/* Row 1 (below address): Rating & Price Range in opposite corners */}
              <div className="flex justify-between">
                {location.rating && (
                  <div>
                    <div className="font-medium text-gray-900 text-sm">Rating</div>
                    <div className="text-gray-600 text-sm">‚≠ê {location.rating}/5</div>
                  </div>
                )}
                {location.priceRange && (
                  <div>
                    <div className="font-medium text-gray-900 text-sm">Price Range</div>
                    <div className="text-gray-600 text-sm">{location.priceRange}</div>
                  </div>
                )}
              </div>

              {/* Separator */}
              <svg xmlns="http://www.w3.org/2000/svg" width="292" height="1" viewBox="0 0 292 1" fill="none">
                <path d="M0 0.5H291.5" stroke="#DBDBDB" strokeWidth="1"/>
              </svg>

              {/* Column 2: Website & AR Experience */}
              <div className="space-y-3">
                {/* Website */}
                <div>
                  <div className="flex items-center gap-1 mb-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="14" viewBox="0 0 10 9" fill="none">
                      <path d="M8.4105 0.798979L8.24679 0.636463C7.39373 -0.212221 6.00488 -0.212121 5.15152 0.636563L4.16944 1.61326C3.99266 1.78898 3.99266 2.07401 4.16944 2.24972C4.34613 2.42554 4.63273 2.42554 4.80941 2.24972L5.79149 1.27313C6.29209 0.775277 7.10633 0.775277 7.60702 1.27313L7.77063 1.43564C8.27113 1.93349 8.27113 2.74347 7.77063 3.24112L6.19927 4.80398C6.0077 4.9945 5.76555 5.11791 5.49946 5.16091C5.09209 5.22672 4.67527 5.09351 4.38414 4.80428L4.22063 4.64166C4.17266 4.59376 4.12852 4.54225 4.089 4.48845C3.94188 4.28753 3.659 4.24322 3.45677 4.38954C3.25464 4.53585 3.21009 4.81738 3.35731 5.0184C3.42409 5.10951 3.4989 5.19662 3.58016 5.27762L3.74407 5.44094C4.15698 5.85138 4.7179 6.0779 5.29412 6.0779C5.41077 6.0779 5.52822 6.0687 5.64498 6.0497C6.09961 5.97619 6.51241 5.76557 6.83944 5.44054L8.4105 3.87779C9.26386 3.0291 9.26396 1.64816 8.4105 0.798979Z" fill="#989898"/>
                      <path d="M4.24226 6.75023L3.26019 7.72683C2.75949 8.22468 1.94535 8.22468 1.44486 7.72703L1.28115 7.56391C1.03869 7.32289 0.905149 7.00255 0.905149 6.66152C0.905149 6.32059 1.03869 6.00016 1.28105 5.75893L2.85251 4.19608C3.04388 4.00576 3.28593 3.88224 3.55211 3.83894C3.95949 3.77333 4.37651 3.90655 4.66784 4.19618L4.83125 4.35879C4.87942 4.4064 4.92336 4.4578 4.96268 4.51131C5.1098 4.71243 5.39258 4.75663 5.59491 4.61052C5.79704 4.4642 5.84149 4.18277 5.69447 3.98155C5.62769 3.89054 5.55288 3.80334 5.47142 3.72233L5.30771 3.55961C4.81104 3.06546 4.10047 2.83774 3.4063 2.95045C2.95156 3.02436 2.53866 3.23498 2.21254 3.55961L0.640975 5.12227C0.22767 5.53351 0 6.08016 0 6.66162C0.000100561 7.24298 0.227771 7.78963 0.640975 8.20037L0.804689 8.36339C1.23147 8.78783 1.792 8.99995 2.35242 8.99995C2.91295 8.99995 3.47348 8.78783 3.90006 8.36329L4.88223 7.38689C5.05912 7.21108 5.05912 6.92615 4.88233 6.75033C4.70545 6.57461 4.41905 6.57451 4.24226 6.75023Z" fill="#989898"/>
                    </svg>
                    <span className="font-medium text-gray-900 text-sm">Website</span>
                  </div>
                  {location.website ? (
                    <a
                      href={location.website}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="text-sm"
                      style={{ color: '#0096FA' }}
                    >
                      {location.website}
                    </a>
                  ) : (
                    <div className="text-gray-600 text-sm">
                      Link will be added soon
                    </div>
                  )}
                </div>

                {/* Separator */}
                <svg xmlns="http://www.w3.org/2000/svg" width="292" height="1" viewBox="0 0 292 1" fill="none">
                  <path d="M0 0.5H291.5" stroke="#DBDBDB" strokeWidth="1"/>
                </svg>

                {/* AR Experience */}
                <div>
                  <div className="flex items-center gap-1 mb-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 15 15" fill="none">
                      <path d="M7.63897 13.8498L13.0112 10.797C13.0973 10.747 13.1529 10.6553 13.1529 10.5553V4.44421C13.1529 4.41921 13.1501 4.39421 13.1446 4.37199C13.1446 4.36365 13.1362 4.35532 13.1335 4.34699L13.1168 4.30532C13.1112 4.29699 13.1057 4.29143 13.1001 4.2831C13.0918 4.27199 13.0835 4.2581 13.0723 4.24976C13.0668 4.24421 13.0585 4.23865 13.0501 4.2331C13.039 4.22476 13.0279 4.21365 13.0168 4.20532L7.64186 1.14967C7.55574 1.10245 7.45297 1.10245 7.36685 1.14967L1.99192 4.20532C1.98636 4.2081 1.98081 4.21643 1.97247 4.21921C1.96692 4.22476 1.95858 4.22754 1.95303 4.2331C1.94747 4.23865 1.93914 4.24143 1.93358 4.24699C1.92247 4.2581 1.91692 4.26921 1.90581 4.28032C1.90025 4.28865 1.89192 4.29421 1.88914 4.30254C1.88358 4.31365 1.87803 4.32754 1.87247 4.34143C1.86969 4.34976 1.86414 4.3581 1.86136 4.36643C1.86136 4.37476 1.86136 4.38587 1.85858 4.39421C1.85858 4.40254 1.85858 4.41087 1.85581 4.41921C1.85581 4.42754 1.85303 4.43309 1.85303 4.44143V10.5525C1.85303 10.6525 1.90581 10.7442 1.99469 10.7942L7.36696 13.847C7.36696 13.847 7.39474 13.8609 7.40863 13.8665C7.41696 13.8692 7.4253 13.8748 7.43363 13.8776C7.45585 13.8831 7.48085 13.8859 7.50585 13.8859C7.53085 13.8859 7.55307 13.8831 7.57807 13.8776C7.58641 13.8776 7.59474 13.872 7.60307 13.8665C7.61696 13.8609 7.63085 13.8581 7.64474 13.8498L7.63897 13.8498ZM12.5974 10.3941L7.77799 13.133V7.66081L12.0836 5.21352L12.0864 5.21075L12.5947 4.92186V10.394L12.5974 10.3941ZM7.50012 1.7081L12.314 4.44428L11.7695 4.75539H11.7668L7.93068 6.93601L7.50012 7.18046L7.06956 6.93601L3.23347 4.75539H3.23069L2.68625 4.44428L7.50012 1.7081ZM2.40288 4.92197L2.91122 5.21086L2.91399 5.21363L7.21959 7.66092V13.1331L2.40022 10.3943V4.92208L2.40288 4.92197Z" fill="#909191"/>
                      <path d="M0.277778 2.77778C0.430556 2.77778 0.555556 2.65278 0.555556 2.5V0.833333C0.555556 0.680555 0.680555 0.555555 0.833333 0.555555H2.5C2.65278 0.555555 2.77778 0.430556 2.77778 0.277778C2.77778 0.124999 2.65278 0 2.5 0H0.833333C0.375004 0 0 0.375004 0 0.833333V2.5C0 2.65278 0.124999 2.77778 0.277778 2.77778Z" fill="#909191"/>
                      <path d="M2.5 14.4443H0.833333C0.680555 14.4443 0.555556 14.3193 0.555556 14.1666V12.4999C0.555556 12.3471 0.430556 12.2221 0.277778 12.2221C0.124999 12.2221 0 12.3471 0 12.4999V14.1666C0 14.6249 0.375004 14.9999 0.833333 14.9999H2.5C2.65278 14.9999 2.77778 14.8749 2.77778 14.7221C2.77778 14.5693 2.65278 14.4443 2.5 14.4443Z" fill="#909191"/>
                      <path d="M14.7222 12.2221C14.5694 12.2221 14.4444 12.3471 14.4444 12.4999V14.1666C14.4444 14.3193 14.3194 14.4443 14.1666 14.4443H12.4999C12.3472 14.4443 12.2222 14.5693 12.2222 14.7221C12.2222 14.8749 12.3472 14.9999 12.4999 14.9999H14.1666C14.6249 14.9999 14.9999 14.6249 14.9999 14.1666V12.4999C14.9999 12.3471 14.8749 12.2221 14.7222 12.2221Z" fill="#909191"/>
                      <path d="M14.1666 0H12.4999C12.3472 0 12.2222 0.124999 12.2222 0.277778C12.2222 0.430556 12.3472 0.555556 12.4999 0.555556H14.1666C14.3194 0.555556 14.4444 0.680555 14.4444 0.833333V2.5C14.4444 2.65278 14.5694 2.77778 14.7222 2.77778C14.8749 2.77778 14.9999 2.65278 14.9999 2.5V0.833333C14.9999 0.375004 14.6249 0 14.1666 0Z" fill="#909191"/>
                    </svg>
                    <span className="font-medium text-gray-900 text-sm">AR Experience</span>
                  </div>
                  <a
                    href="#ar-experience"
                    onClick={(e) => {
                      e.preventDefault();
                      e.stopPropagation();
                      alert('AR Experience coming soon! This will launch an immersive AR view of ' + location.name);
                    }}
                    className="text-sm"
                    style={{ color: '#0096FA', cursor: 'pointer', touchAction: 'manipulation' }}
                  >
                    View in AR &gt;
                  </a>
                </div>
              </div>

              {/* Separator */}
              <svg xmlns="http://www.w3.org/2000/svg" width="292" height="1" viewBox="0 0 292 1" fill="none">
                <path d="M0 0.5H291.5" stroke="#DBDBDB" strokeWidth="1"/>
              </svg>

              {/* Column 3: Virtual Tours */}
              <div>
                <div className="flex items-center gap-1 mb-1">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="28" viewBox="0 0 15 18" fill="none">
                    <path d="M5.85519 10.0785C5.61285 10.0785 5.37052 10.0785 5.12819 10.0785C5.08324 10.0785 5.03829 10.0785 4.99334 10.0785C4.98357 10.0785 4.97184 10.0765 4.96403 10.0785C4.9308 10.0804 4.96989 10.0785 4.97771 10.0804C4.96598 10.0765 4.9523 10.0746 4.94058 10.0707C4.90931 10.057 4.95035 10.0746 4.9523 10.0765C4.93862 10.0687 4.92299 10.0609 4.90931 10.0511C4.9523 10.0843 4.89367 10.0257 4.9269 10.0687C4.91322 10.0511 4.89172 10.0042 4.90931 10.0511C4.90149 10.0276 4.89758 9.97874 4.89758 10.0276C4.89758 10.0179 4.89563 10.01 4.89758 10.0003C4.89758 9.98852 4.89758 9.97874 4.89758 9.96701C4.89563 9.49375 4.89758 9.0205 4.89758 8.54529C4.89758 8.01337 4.89758 7.4834 4.89758 6.95148C4.89758 6.91237 4.89758 6.87521 4.89758 6.8361C4.89758 6.80872 4.89758 6.77939 4.89954 6.75201C4.90149 6.72463 4.90149 6.69725 4.9054 6.66987C4.90735 6.65618 4.90735 6.64249 4.90931 6.6288C4.91322 6.58187 4.90149 6.67378 4.90931 6.62685C4.9269 6.51734 4.9523 6.40978 4.98748 6.30613C4.9953 6.28071 5.00507 6.25724 5.01484 6.23182C5.03438 6.17902 5.00116 6.25724 5.02461 6.2064C5.04806 6.15555 5.07347 6.1047 5.10083 6.05581C5.12623 6.01084 5.15359 5.96781 5.18095 5.92479C5.19463 5.90328 5.21027 5.88372 5.2259 5.86221C5.24545 5.83483 5.22199 5.86612 5.21809 5.87003C5.22786 5.85634 5.23958 5.84266 5.24936 5.83092C5.31776 5.74879 5.39202 5.67252 5.47214 5.60212C5.49169 5.58452 5.51123 5.56887 5.53077 5.55323C5.55618 5.53172 5.52687 5.55714 5.52296 5.55909C5.53273 5.55127 5.54445 5.54345 5.55423 5.53563C5.59917 5.50434 5.64608 5.47305 5.69493 5.44567C5.73988 5.42025 5.78483 5.39482 5.83174 5.37331C5.85519 5.36158 5.87864 5.3518 5.90209 5.34202C5.85323 5.36353 5.92554 5.3342 5.94118 5.32833C6.04475 5.29118 6.15029 5.2638 6.25973 5.24424C6.27927 5.24033 6.33985 5.23446 6.28709 5.24033C6.31445 5.23838 6.34181 5.23446 6.36721 5.23251C6.41216 5.2286 6.45907 5.2286 6.50401 5.2286C6.51965 5.2286 6.53528 5.2286 6.55092 5.2286C6.78543 5.2286 7.0219 5.2286 7.25642 5.2286C7.56324 5.2286 7.87007 5.2286 8.17689 5.2286C8.26679 5.2286 8.35669 5.2286 8.44659 5.2286C8.46027 5.2286 8.4759 5.2286 8.48958 5.2286C8.53453 5.2286 8.58143 5.23055 8.62638 5.23251C8.65374 5.23446 8.6811 5.23642 8.70651 5.24033C8.65179 5.23446 8.72996 5.24424 8.74755 5.24815C8.85503 5.26771 8.96252 5.29704 9.06414 5.3342C9.08173 5.34007 9.13645 5.36353 9.0915 5.34398C9.11496 5.35376 9.13841 5.36549 9.16186 5.37527C9.21267 5.39873 9.26153 5.42611 9.31039 5.45545C9.35533 5.48087 9.39638 5.5102 9.43937 5.53954C9.44914 5.54736 9.46087 5.55518 9.47064 5.563C9.46673 5.56105 9.43546 5.53563 9.46282 5.55714C9.48627 5.57669 9.50972 5.59429 9.53122 5.61385C9.61135 5.68425 9.68561 5.76052 9.75401 5.84265C9.76183 5.85243 9.76965 5.86221 9.77746 5.87199C9.77551 5.86808 9.75206 5.83679 9.76965 5.86417C9.78528 5.88568 9.79896 5.90523 9.81459 5.92675C9.84586 5.97368 9.87518 6.02061 9.90058 6.0695C9.92599 6.11448 9.94749 6.16142 9.96898 6.20835C9.99244 6.2592 9.96117 6.18097 9.97876 6.23377C9.98853 6.26311 10.0003 6.29049 10.01 6.31982C10.0452 6.42542 10.0706 6.53298 10.0843 6.64249C10.0765 6.59165 10.0843 6.65227 10.0862 6.67183C10.0882 6.69921 10.0902 6.72658 10.0921 6.75396C10.0941 6.78134 10.0941 6.81068 10.0941 6.83805C10.096 7.24873 10.0941 7.6594 10.0941 8.07008C10.0941 8.63916 10.0941 9.20824 10.0941 9.77731C10.0941 9.84185 10.0941 9.90443 10.0941 9.96896C10.0941 9.97874 10.0941 9.99048 10.0941 10.0003C10.0941 10.01 10.0941 10.0179 10.0941 10.0276C10.096 9.97874 10.0921 10.0276 10.0823 10.0511C10.0999 10.0042 10.0784 10.0531 10.0647 10.0687C10.0667 10.0648 10.0941 10.0335 10.0706 10.057C10.0393 10.0883 10.1058 10.0296 10.0726 10.0589C10.0628 10.0667 10.0511 10.0726 10.0413 10.0785C10.0452 10.0765 10.0843 10.0589 10.053 10.0726C10.0413 10.0785 10.0276 10.0785 10.0159 10.0824C10.0237 10.0804 10.0608 10.0824 10.0296 10.0804C10.0198 10.0804 10.0081 10.0804 9.99634 10.0804C9.94944 10.0804 9.90254 10.0804 9.85563 10.0804C9.7032 10.0804 9.54881 10.0804 9.39637 10.0804C9.31039 10.0804 9.22244 10.0804 9.13645 10.0804C8.97816 10.0804 8.84331 10.2154 8.84331 10.3738C8.84331 11.0309 8.84331 11.6879 8.84331 12.345C8.84331 12.7127 8.84331 13.0784 8.84331 13.446C8.84331 13.5105 8.84135 13.5731 8.84331 13.6377C8.84331 13.6455 8.8394 13.7276 8.84331 13.665C8.84526 13.5868 8.84526 13.667 8.8394 13.6631C8.85113 13.6729 8.8179 13.7022 8.84135 13.6631C8.84135 13.6611 8.80031 13.7335 8.82181 13.6944C8.84135 13.6611 8.78859 13.7139 8.82181 13.6944C8.85894 13.6729 8.78859 13.7139 8.79054 13.7139C8.82963 13.6905 8.80031 13.7237 8.79054 13.712C8.78273 13.7139 8.77491 13.7159 8.76514 13.7178C8.80031 13.7139 8.80031 13.7139 8.76514 13.7159C8.74559 13.7159 8.72605 13.7159 8.70651 13.7159C7.95215 13.7159 7.19584 13.7159 6.44148 13.7159C6.36135 13.7159 6.27927 13.7198 6.19914 13.7159C6.26168 13.7198 6.14638 13.6826 6.2011 13.7139C6.18742 13.7061 6.17178 13.6983 6.1581 13.6885C6.21478 13.7315 6.16006 13.6866 6.16201 13.6846C6.16006 13.6866 6.18937 13.7198 6.15615 13.6748C6.13074 13.6396 6.1796 13.712 6.15615 13.6768C6.14638 13.6631 6.14442 13.6044 6.14833 13.667C6.14833 13.6611 6.14638 13.6455 6.14833 13.6396C6.14833 13.622 6.14833 13.6025 6.14833 13.5849C6.14833 13.2778 6.14833 12.9708 6.14833 12.6638C6.14833 11.9167 6.14833 11.1677 6.14833 10.4207C6.14833 10.4051 6.14833 10.3914 6.14833 10.3757C6.14833 10.2193 6.01349 10.0726 5.85519 10.0785C5.69689 10.0863 5.56204 10.2075 5.56204 10.3718C5.56204 11.0582 5.56204 11.7427 5.56204 12.4291C5.56204 12.7889 5.56204 13.1488 5.56204 13.5086C5.56204 13.6298 5.56009 13.7491 5.60504 13.8665C5.71448 14.15 5.9744 14.3026 6.27145 14.3026C7.03949 14.3026 7.80753 14.3026 8.57557 14.3026C8.69087 14.3026 8.81204 14.3104 8.92539 14.283C9.23612 14.2126 9.43155 13.9232 9.43351 13.6142C9.43546 13.3287 9.43351 13.0432 9.43351 12.7576C9.43351 11.9774 9.43351 11.199 9.43351 10.4187C9.43351 10.4031 9.43351 10.3875 9.43351 10.3699C9.33579 10.4676 9.23808 10.5654 9.14036 10.6632C9.39442 10.6632 9.64848 10.6632 9.90254 10.6632C10.0667 10.6632 10.227 10.6534 10.3716 10.5615C10.5709 10.4344 10.6784 10.2212 10.6843 9.98852C10.694 9.52309 10.6843 9.05766 10.6843 8.59222C10.6843 8.04075 10.6843 7.48731 10.6843 6.93583C10.6843 6.64836 10.6549 6.36089 10.5533 6.08906C10.3755 5.61776 10.053 5.21491 9.62112 4.95286C9.2713 4.74165 8.86871 4.63996 8.46027 4.63996C8.2238 4.63996 7.98537 4.63996 7.7489 4.63996C7.43231 4.63996 7.11376 4.63996 6.79716 4.63996C6.54115 4.63996 6.291 4.63801 6.03694 4.69081C5.03829 4.8981 4.31911 5.82114 4.31325 6.83414C4.31129 7.2546 4.31325 7.67505 4.31325 8.0955C4.31325 8.67436 4.31325 9.25517 4.31325 9.83403C4.31325 9.88683 4.31129 9.93767 4.31325 9.99048C4.31911 10.2271 4.43246 10.4422 4.63571 10.5693C4.78032 10.6573 4.93862 10.6652 5.10083 10.6652C5.25913 10.6652 5.41938 10.6652 5.57768 10.6652C5.66953 10.6652 5.76334 10.6652 5.85519 10.6652C6.00762 10.6652 6.15615 10.5302 6.14833 10.3718C6.14051 10.2134 6.01935 10.0785 5.85519 10.0785Z" fill="#A8A8A8"/>
                    <path d="M8.92738 2.01751C8.92738 2.06249 8.92543 2.10747 8.92152 2.15441C8.91957 2.17201 8.91761 2.18961 8.91566 2.20721C8.90784 2.29325 8.92152 2.17005 8.9137 2.22285C8.90002 2.30499 8.88048 2.38517 8.85507 2.46535C8.84139 2.50641 8.82771 2.54748 8.81013 2.58659C8.83162 2.53184 8.78863 2.62962 8.78081 2.64526C8.74173 2.72153 8.69678 2.79389 8.64792 2.86429C8.6401 2.87602 8.60492 2.921 8.6401 2.87602C8.63033 2.88971 8.61861 2.9034 8.60883 2.91513C8.58147 2.94838 8.55411 2.97967 8.52284 3.009C8.49939 3.03247 8.47399 3.05789 8.45054 3.0794C8.4349 3.09309 8.41927 3.10678 8.40363 3.12243C8.39777 3.12829 8.33719 3.17523 8.36455 3.15567C8.39777 3.13025 8.33132 3.17914 8.33328 3.17718C8.3196 3.18696 8.30592 3.19674 8.29028 3.20652C8.25511 3.22998 8.21797 3.25149 8.18084 3.27301C8.15153 3.28865 8.12026 3.30625 8.08899 3.31994C8.08117 3.32385 8.003 3.3571 8.06554 3.33167C8.04209 3.34145 8.01668 3.35123 7.99323 3.35905C7.91897 3.38448 7.84275 3.40599 7.76653 3.42163C7.74894 3.42554 7.73135 3.4275 7.71376 3.43141C7.62973 3.44705 7.7509 3.4275 7.70009 3.43337C7.65123 3.43923 7.60237 3.44314 7.55156 3.4451C7.46948 3.44705 7.38935 3.44314 7.30727 3.43532C7.24864 3.42945 7.29359 3.43337 7.30532 3.43532C7.28382 3.43141 7.26232 3.4275 7.24082 3.42359C7.19392 3.41381 7.14702 3.40403 7.10012 3.39034C7.06298 3.37861 7.02585 3.36688 6.98872 3.35514C6.96918 3.34732 6.94768 3.3395 6.92814 3.33167C6.93986 3.33559 6.97699 3.35514 6.92618 3.32972C6.84997 3.29256 6.77375 3.25345 6.70144 3.20652C6.68776 3.19674 6.67212 3.18696 6.65844 3.17718C6.6604 3.17914 6.592 3.12829 6.62718 3.15567C6.6604 3.18109 6.59591 3.13025 6.59786 3.13025C6.58418 3.11851 6.57246 3.10874 6.55878 3.097C6.49624 3.04029 6.43565 2.97967 6.38093 2.91513C6.38289 2.91709 6.33012 2.8506 6.35553 2.8858C6.38093 2.91904 6.33208 2.85255 6.33403 2.85451C6.31449 2.82713 6.29495 2.7978 6.27736 2.76846C6.25586 2.73131 6.23436 2.69415 6.21482 2.65699C6.20505 2.63744 6.15814 2.53184 6.17964 2.58659C6.15033 2.51424 6.12688 2.43992 6.10733 2.36365C6.09561 2.32063 6.08779 2.27761 6.07997 2.23458C6.06825 2.17787 6.07802 2.2209 6.07802 2.23263C6.07411 2.20525 6.07216 2.17983 6.0702 2.15245C6.06434 2.0664 6.06238 1.98036 6.0702 1.89431C6.07216 1.87671 6.08583 1.76524 6.07606 1.82587C6.08388 1.77893 6.09365 1.73004 6.10538 1.68311C6.12492 1.60684 6.14837 1.53253 6.17573 1.46017C6.19332 1.41323 6.14446 1.52079 6.1816 1.44648C6.18941 1.43083 6.19528 1.41519 6.20309 1.39955C6.22459 1.35652 6.24609 1.31545 6.27149 1.27634C6.29104 1.2431 6.31253 1.21181 6.33403 1.18052C6.3438 1.16683 6.35357 1.15314 6.36335 1.13945C6.32426 1.19225 6.37507 1.12576 6.38093 1.11794C6.43175 1.05536 6.48842 0.998648 6.549 0.943891C6.57832 0.918469 6.60568 0.893046 6.63695 0.869579C6.592 0.904779 6.63695 0.869579 6.64867 0.861756C6.66626 0.850023 6.68385 0.838289 6.70144 0.826556C6.77375 0.779621 6.84801 0.740509 6.92618 0.703353C6.93595 0.699442 6.97699 0.681842 6.92814 0.701398C6.94377 0.695531 6.95941 0.687708 6.97699 0.681842C7.01803 0.666197 7.05908 0.652508 7.10012 0.640774C7.13725 0.62904 7.17633 0.621218 7.21542 0.61144C7.23692 0.607529 7.25841 0.603618 7.27991 0.599706C7.34245 0.586017 7.23692 0.601662 7.30727 0.595795C7.38935 0.587973 7.46948 0.584062 7.55156 0.586017C7.5926 0.587973 7.63168 0.589929 7.67272 0.59384C7.68836 0.595795 7.74699 0.605573 7.68836 0.595795C7.71376 0.599706 7.74112 0.605573 7.76653 0.609484C7.85643 0.627085 7.94437 0.654463 8.03036 0.685753C8.04404 0.689664 8.09681 0.713131 8.04404 0.689664C8.06749 0.699442 8.09094 0.711175 8.1144 0.722909C8.15348 0.742465 8.19061 0.762021 8.22775 0.783532C8.27269 0.808955 8.31373 0.838289 8.35673 0.867623C8.3665 0.87349 8.40168 0.900868 8.35868 0.867623C8.37823 0.883268 8.39777 0.898913 8.41731 0.916513C8.48767 0.977137 8.55411 1.04363 8.61274 1.11598C8.62447 1.12967 8.63424 1.14141 8.64401 1.1551C8.60492 1.10621 8.65574 1.1727 8.65965 1.17856C8.68701 1.21767 8.71241 1.25679 8.73586 1.29785C8.75931 1.33892 8.78081 1.37999 8.80231 1.42301C8.81013 1.43866 8.81599 1.4543 8.82381 1.46995C8.7984 1.41128 8.83162 1.4895 8.83358 1.49537C8.8668 1.58533 8.89221 1.6792 8.90979 1.77306C8.9137 1.79066 8.91566 1.80826 8.91957 1.82587C8.90784 1.76329 8.92152 1.83955 8.92152 1.85324C8.92543 1.908 8.92738 1.96276 8.92738 2.01751C8.92934 2.17005 9.06223 2.31868 9.22053 2.31085C9.37883 2.30303 9.51563 2.18178 9.51367 2.01751C9.50781 1.16487 8.97038 0.411969 8.17302 0.116674C7.40108 -0.168843 6.47083 0.0834291 5.95099 0.722909C5.41356 1.3839 5.3217 2.32845 5.77315 3.06571C6.21873 3.7932 7.07666 4.15694 7.90919 3.99267C8.83749 3.8108 9.50586 2.95424 9.51367 2.01751C9.51563 1.86498 9.37883 1.71635 9.22053 1.72417C9.06028 1.73004 8.92934 1.85129 8.92738 2.01751Z" fill="#A8A8A8"/>
                    <path d="M11.722 11.0602C11.9722 11.1462 12.2165 11.2401 12.4334 11.3379C12.6484 11.4356 12.8575 11.5432 13.0607 11.6625C13.1584 11.7212 13.2561 11.7818 13.35 11.8463C13.3871 11.8717 13.4262 11.8991 13.4633 11.9265C13.4848 11.9421 13.5063 11.9578 13.5278 11.9754C13.5552 11.9969 13.5571 11.9969 13.5317 11.9793C13.5454 11.991 13.5591 12.0008 13.5727 12.0125C13.7252 12.1357 13.8678 12.2687 13.9968 12.4154C14.0242 12.4486 14.0515 12.4799 14.0789 12.5132C14.034 12.4565 14.0809 12.5171 14.0887 12.5269C14.1024 12.5445 14.1141 12.564 14.1278 12.5816C14.1766 12.654 14.2235 12.7283 14.2626 12.8065C14.2822 12.8437 14.2997 12.8828 14.3173 12.9219C14.2822 12.8495 14.3271 12.9473 14.3349 12.9669C14.3642 13.047 14.3857 13.1292 14.4033 13.2133C14.4072 13.2289 14.4092 13.2465 14.4111 13.2622C14.4229 13.3326 14.4053 13.1937 14.4111 13.2641C14.415 13.3052 14.419 13.3443 14.419 13.3854C14.4209 13.4538 14.417 13.5203 14.4111 13.5868C14.4053 13.6494 14.4229 13.5829 14.4131 13.5731C14.417 13.577 14.4072 13.6142 14.4053 13.62C14.4014 13.6474 14.3955 13.6728 14.3896 13.6983C14.374 13.7667 14.3525 13.8352 14.3291 13.9016C14.3251 13.9114 14.3212 13.9232 14.3173 13.9329C14.3076 13.9603 14.3095 13.9955 14.3212 13.9251C14.3173 13.9544 14.2919 13.9896 14.2782 14.017C14.247 14.0796 14.2138 14.1383 14.1766 14.1969C14.1414 14.2517 14.1024 14.3045 14.0652 14.3573C14.1199 14.283 14.0457 14.3808 14.03 14.3984C14.0027 14.4316 13.9734 14.4649 13.9421 14.4981C13.8385 14.6096 13.7252 14.7152 13.6079 14.8129C13.5923 14.8266 13.4887 14.9068 13.5512 14.8579C13.5219 14.8794 13.4946 14.901 13.4653 14.9225C13.3871 14.9792 13.307 15.0339 13.2268 15.0848C13.0744 15.1826 12.9161 15.2725 12.7558 15.3546C12.6738 15.3957 12.5917 15.4368 12.5096 15.4759C12.4627 15.4974 12.4158 15.5189 12.3689 15.5404C12.3454 15.5502 12.322 15.5619 12.2985 15.5717C12.2673 15.5854 12.2673 15.5854 12.2966 15.5737C12.281 15.5795 12.2634 15.5874 12.2477 15.5932C11.8412 15.7614 11.4211 15.8963 10.995 16.0078C10.0003 16.2679 9.0505 16.3872 8.02644 16.4204C7.47924 16.438 6.93204 16.4283 6.38679 16.3911C5.85913 16.354 5.40769 16.2992 4.89957 16.2053C4.4364 16.1212 3.97519 16.0117 3.5257 15.8709C3.32245 15.8083 3.12116 15.7379 2.92182 15.6617C2.87101 15.6421 2.82215 15.6226 2.77329 15.603C2.74984 15.5932 2.72444 15.5835 2.70098 15.5737C2.76157 15.5991 2.68144 15.5659 2.67558 15.5619C2.58177 15.5209 2.48992 15.4779 2.39807 15.4348C2.06975 15.2764 1.75706 15.0906 1.46391 14.8716C1.40529 14.8286 1.51277 14.9107 1.4561 14.8658C1.44437 14.856 1.4346 14.8482 1.42287 14.8403C1.3916 14.8149 1.35838 14.7875 1.32711 14.7601C1.26653 14.7073 1.2079 14.6526 1.15123 14.5978C1.09651 14.5431 1.04374 14.4883 0.994883 14.4297C0.97534 14.4062 0.955797 14.3827 0.936254 14.3573C0.924528 14.3436 0.887396 14.2908 0.936254 14.3593C0.922574 14.3397 0.906939 14.3201 0.893259 14.3006C0.815087 14.1911 0.750595 14.0776 0.691966 13.9564C0.682195 13.9349 0.650926 13.8977 0.693921 13.9662C0.686103 13.9525 0.680241 13.9349 0.676332 13.9192C0.664606 13.888 0.65288 13.8567 0.643109 13.8254C0.623566 13.7628 0.607931 13.7002 0.596206 13.6376C0.592297 13.622 0.590343 13.6063 0.588389 13.5907C0.576663 13.534 0.594252 13.6533 0.590343 13.6122C0.588389 13.5829 0.58448 13.5535 0.582526 13.5242C0.578617 13.4499 0.578617 13.3775 0.58448 13.3032C0.586434 13.2817 0.588389 13.2622 0.590343 13.2426C0.582526 13.3267 0.588389 13.2563 0.592297 13.2387C0.600114 13.1976 0.607932 13.1566 0.617703 13.1174C0.62552 13.0842 0.635292 13.051 0.647018 13.0177C0.65288 12.9982 0.660698 12.9786 0.668515 12.959C0.674378 12.9434 0.711509 12.8554 0.678286 12.9297C0.748641 12.7733 0.836584 12.6266 0.940162 12.4917C0.897168 12.5484 0.946025 12.4858 0.951888 12.478C0.967522 12.4604 0.983157 12.4408 0.998791 12.4232C1.03006 12.3861 1.06328 12.3509 1.09846 12.3157C1.16882 12.2413 1.24308 12.1729 1.3193 12.1064C1.36034 12.0712 1.40138 12.038 1.44242 12.0047C1.44828 11.9988 1.48541 11.9715 1.44633 12.0008C1.46782 11.9832 1.48932 11.9676 1.51277 11.9519C1.60462 11.8835 1.69843 11.8209 1.79419 11.7603C2.00135 11.6292 2.21827 11.5119 2.44106 11.4063C2.67167 11.2968 2.86905 11.2166 3.1192 11.1267C3.26773 11.0719 3.3674 10.9272 3.32441 10.7649C3.28532 10.6221 3.11334 10.5067 2.96286 10.5595C2.02871 10.8978 1.06719 11.375 0.449633 12.1807C0.0235965 12.7381 -0.136656 13.4655 0.131083 14.1265C0.396868 14.7777 0.940162 15.2627 1.52645 15.6284C2.27886 16.0997 3.13679 16.4028 3.99473 16.616C5.0481 16.8761 6.13664 17.0013 7.21932 17.0189C8.33913 17.0384 9.46676 16.9445 10.5631 16.7157C11.4601 16.53 12.3533 16.2484 13.1623 15.8103C13.774 15.4798 14.3779 15.0339 14.7297 14.4218C15.0815 13.8117 15.0912 13.0959 14.7512 12.476C14.3173 11.686 13.4731 11.1658 12.6718 10.8098C12.4119 10.6945 12.1481 10.5908 11.8803 10.4989C11.7357 10.45 11.554 10.5556 11.5188 10.7042C11.4797 10.8626 11.5657 11.0074 11.722 11.0602Z" fill="#A8A8A8"/>
                  </svg>
                  <span className="font-medium text-gray-900 text-sm">Virtual Tours</span>
                </div>
                <a
                  href="#virtual-tours"
                  onClick={(e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    alert('Virtual Tours coming soon!');
                  }}
                  className="text-sm"
                  style={{ color: '#0096FA', cursor: 'pointer', touchAction: 'manipulation' }}
                >
                  View virtual tours &gt;
                </a>
              </div>
            </div>
          </div>

          {/* Deals Section */}
          {deals.length > 0 && (
            <div id="deals-section" className="mb-5">
              <div className="mb-3 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 17 17" fill="none">
                  <path d="M11.0734 10.0863C11.0837 10.1774 11.0742 10.2697 11.0455 10.3567C11.0167 10.4438 10.9695 10.5236 10.9069 10.5907C10.8444 10.6578 10.768 10.7105 10.6832 10.7452C10.5983 10.78 10.5069 10.7959 10.4153 10.7919C10.3246 10.7953 10.2343 10.7788 10.1507 10.7435C10.0671 10.7083 9.99213 10.6552 9.93118 10.588C9.87022 10.5208 9.82469 10.441 9.79779 10.3544C9.77089 10.2677 9.76326 10.1762 9.77543 10.0863C9.76284 9.99529 9.77004 9.90266 9.79653 9.81471C9.82302 9.72677 9.86818 9.64558 9.92893 9.57669C9.98968 9.5078 10.0646 9.45284 10.1485 9.41556C10.2325 9.37828 10.3235 9.35955 10.4153 9.36067C10.5083 9.35821 10.6007 9.37586 10.6862 9.41241C10.7718 9.44896 10.8484 9.50355 10.9109 9.57244C10.9733 9.64134 11.0202 9.72292 11.0483 9.8116C11.0763 9.90028 11.0849 9.99397 11.0734 10.0863Z" fill="#0096FA"/>
                  <path d="M6.81854 5.97692C6.72677 5.97593 6.63587 5.99474 6.55203 6.03208C6.4682 6.06942 6.3934 6.1244 6.33274 6.19327C6.27209 6.26214 6.22701 6.34329 6.20056 6.43117C6.17412 6.51905 6.16695 6.61161 6.17953 6.70251C6.16737 6.79236 6.17498 6.88379 6.20183 6.97039C6.22868 7.057 6.27413 7.13669 6.33499 7.2039C6.39585 7.27111 6.47066 7.32422 6.55418 7.3595C6.6377 7.39479 6.72792 7.41141 6.81854 7.40819C6.90976 7.41056 7.00044 7.39354 7.0846 7.35827C7.16876 7.323 7.24447 7.27028 7.30675 7.20359C7.36903 7.13689 7.41644 7.05774 7.44587 6.97137C7.4753 6.88499 7.48606 6.79336 7.47746 6.70251C7.48723 6.61047 7.47743 6.51739 7.44868 6.42941C7.41994 6.34142 7.37291 6.26051 7.31068 6.19198C7.24845 6.12346 7.17243 6.06887 7.08762 6.03181C7.0028 5.99474 6.9111 5.97604 6.81854 5.97692ZM16.8037 9.00744L8.61953 0.819847C8.50598 0.705835 8.35561 0.63587 8.19526 0.62243L0.736724 0.00247279C0.638174 -0.00596179 0.538971 0.00724137 0.446058 0.0411583C0.353145 0.0750752 0.268766 0.128887 0.198826 0.198826C0.128887 0.268766 0.0750752 0.353145 0.0411583 0.446058C0.00724137 0.538971 -0.00596179 0.638174 0.00247279 0.736724L0.623296 8.19613C0.636101 8.35697 0.705782 8.508 0.819847 8.62213L9.00051 16.8002C9.06358 16.8635 9.13854 16.9138 9.22108 16.9481C9.30362 16.9823 9.39212 17 9.4815 17C9.57088 17 9.65938 16.9823 9.74192 16.9481C9.82446 16.9138 9.89941 16.8635 9.96248 16.8002L16.8028 9.95989C16.8661 9.89681 16.9164 9.82186 16.9507 9.73932C16.9849 9.65678 17.0026 9.56828 17.0026 9.4789C17.0026 9.38952 16.9849 9.30102 16.9507 9.21848C16.9164 9.13594 16.8661 9.06098 16.8028 8.99791L16.8037 9.00744ZM3.09273 4.29455C2.87511 4.29455 2.66237 4.23003 2.48141 4.10914C2.30045 3.98825 2.1594 3.81643 2.07608 3.61539C1.99276 3.41435 1.97091 3.19311 2.01331 2.97966C2.0557 2.7662 2.16043 2.57011 2.31425 2.41617C2.46807 2.26222 2.66408 2.15734 2.87751 2.11478C3.09093 2.07222 3.31217 2.09389 3.51328 2.17705C3.71439 2.26021 3.88632 2.40114 4.00735 2.582C4.12838 2.76286 4.19307 2.97555 4.19324 3.19317C4.19336 3.33777 4.16498 3.48097 4.10972 3.61459C4.05447 3.74821 3.97342 3.86963 3.87122 3.97191C3.76902 4.0742 3.64766 4.15534 3.51408 4.2107C3.3805 4.26606 3.23733 4.29455 3.09273 4.29455ZM5.1708 6.69818C5.16538 6.48234 5.20463 6.26772 5.2861 6.06777C5.36757 5.86782 5.48949 5.68688 5.64422 5.5363C5.79895 5.38572 5.98314 5.26875 6.18523 5.19274C6.38731 5.11673 6.60293 5.08332 6.81854 5.09461C7.03582 5.0824 7.2533 5.1149 7.45752 5.19012C7.66173 5.26533 7.84834 5.38165 8.0058 5.53189C8.16325 5.68212 8.28821 5.86306 8.37292 6.06352C8.45764 6.26399 8.50031 6.4797 8.49831 6.69732C8.50167 6.91451 8.45976 7.13003 8.37526 7.33014C8.29076 7.53026 8.16551 7.71058 8.0075 7.85963C7.84948 8.00869 7.66216 8.12321 7.45746 8.1959C7.25276 8.26859 7.03517 8.29786 6.81854 8.28185C6.60357 8.29652 6.38791 8.26611 6.18539 8.19257C5.98286 8.11903 5.79794 8.00398 5.64247 7.85479C5.48701 7.70561 5.36444 7.52558 5.28262 7.32625C5.2008 7.12693 5.16153 6.9127 5.16734 6.69732L5.1708 6.69818ZM6.19252 11.5548L10.2569 5.18985H11.0855L7.01076 11.5539L6.19252 11.5548ZM10.4197 11.6682C10.2073 11.6732 9.99601 11.6356 9.79833 11.5578C9.60065 11.4799 9.42053 11.3633 9.26856 11.2148C9.11658 11.0664 8.99582 10.889 8.91338 10.6932C8.83093 10.4974 8.78846 10.2871 8.78846 10.0746C8.78846 9.86215 8.83093 9.65184 8.91338 9.45602C8.99582 9.26021 9.11658 9.08286 9.26856 8.93439C9.42053 8.78592 9.60065 8.66933 9.79833 8.59146C9.99601 8.5136 10.2073 8.47604 10.4197 8.48099C10.6363 8.46936 10.853 8.50234 11.0564 8.57789C11.2598 8.65344 11.4455 8.76996 11.602 8.92022C11.7585 9.07048 11.8825 9.25128 11.9663 9.45141C12.0501 9.65155 12.0918 9.86676 12.089 10.0837C12.0933 10.3004 12.0524 10.5157 11.9688 10.7157C11.8852 10.9157 11.7608 11.0961 11.6035 11.2453C11.4462 11.3945 11.2595 11.5093 11.0554 11.5822C10.8513 11.6552 10.6341 11.6848 10.4179 11.6691L10.4197 11.6682Z" fill="#0096FA"/>
                </svg>
                <span style={{ color: '#000', fontFamily: 'Figtree', fontSize: '16px', fontWeight: 700 }}>Promos ({deals.length})</span>
              </div>
              <div className="space-y-3">
                {deals.map((deal) => (
                  <div key={deal.id} className="p-3" style={{ borderRadius: '6px', border: '0 solid #C5C5C5', background: '#F5F5F5' }}>
                    <div className="flex items-center justify-between mb-2">
                      <h3 style={{ color: '#000', fontFamily: 'Figtree', fontSize: '14px', fontWeight: 700 }}>{deal.title}</h3>
                      {deal.tags && deal.tags.length > 0 && (
                        <span className="px-2 py-0.5" style={{ borderRadius: '5.5px', background: '#A8DCFF', color: '#0096FA', fontFamily: 'Figtree', fontSize: '10px', fontWeight: 700 }}>
                          {deal.tags[0]}
                        </span>
                      )}
                    </div>
                    {deal.description && (
                      <p className="mb-2" style={{ color: '#000', fontFamily: 'Figtree', fontSize: '12px', fontWeight: 400 }}>
                        {deal.description}
                      </p>
                    )}
                    <p style={{ color: '#000', fontFamily: 'Figtree', fontSize: '12px', fontWeight: 400 }}>
                      {new Date(deal.startsAt).toLocaleDateString('en-US', {
                        month: 'short',
                        day: 'numeric',
                        hour: 'numeric',
                        minute: '2-digit'
                      })}
                      {' - '}
                      {new Date(deal.endsAt).toLocaleDateString('en-US', {
                        month: 'short',
                        day: 'numeric',
                        hour: 'numeric',
                        minute: '2-digit'
                      })}
                    </p>
                    {deal.tags && deal.tags.length > 1 && (
                      <div className="mt-2 flex flex-wrap gap-1">
                        {deal.tags.slice(1).map((tag, idx) => (
                          <span key={idx} className="px-2 py-0.5" style={{ borderRadius: '5.5px', background: '#EBEBEB', color: '#5E5E5E', fontFamily: 'Figtree', fontSize: '10px', fontWeight: 400 }}>
                            {tag}
                          </span>
                        ))}
                      </div>
                    )}
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* Events Section */}
          {events.length > 0 && (
            <div id="events-section" className="mb-5">
              <div className="mb-3 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="17" viewBox="0 0 20 17" fill="none">
                  <path fillRule="evenodd" clipRule="evenodd" d="M2.45452 4.34084L8.36357 0.260347C8.68081 0.0413522 9.07325 -0.0444243 9.4546 0.02188C9.83595 0.0881844 10.175 0.301141 10.3972 0.61392L11.3292 1.92632C11.3429 1.94552 11.3559 1.96508 11.3683 1.985L2.45452 4.34084ZM0.453797 9.07302L0.0496372 7.58528C-0.0504798 7.2163 0.00213118 6.82321 0.195897 6.49248C0.389662 6.16175 0.70871 5.92048 1.08286 5.82174L15.894 1.90795C16.2681 1.80908 16.6667 1.86082 17.0021 2.05177C17.3376 2.24272 17.5823 2.55726 17.6826 2.92619L18.1028 4.4737C18.1622 4.69217 18.155 4.92304 18.0823 5.13753C18.0095 5.35202 17.8743 5.54064 17.6936 5.67988C17.4095 5.89835 17.1974 6.19479 17.0838 6.5319C16.9702 6.86901 16.9602 7.23173 17.0552 7.5744C17.1502 7.91707 17.3458 8.22439 17.6174 8.45767C17.8891 8.69096 18.2246 8.83979 18.5818 8.88544C18.8025 8.91383 19.0096 9.00613 19.177 9.15066C19.3444 9.29519 19.4646 9.48545 19.5223 9.69736L19.9502 11.2733C20.0505 11.6422 19.998 12.0353 19.8044 12.3661C19.6108 12.6969 19.2918 12.9383 18.9177 13.0372L4.10584 16.951C3.73179 17.0498 3.33328 16.998 2.99794 16.807C2.6626 16.6161 2.41789 16.3016 2.31761 15.9328L1.91491 14.4501C1.85126 14.2167 1.85737 13.9702 1.93251 13.7403C2.00765 13.5103 2.14861 13.3067 2.33842 13.1539C2.61115 12.9343 2.8137 12.6417 2.92168 12.3112C3.02966 11.9808 3.03846 11.6266 2.94702 11.2913C2.85559 10.956 2.66781 10.654 2.40631 10.4215C2.14482 10.189 1.82075 10.0361 1.47314 9.98108C1.23267 9.94282 1.00855 9.83682 0.827757 9.67584C0.646968 9.51486 0.517228 9.30577 0.454162 9.07374M13.407 6.66534C13.5476 6.63013 13.6797 6.56773 13.7956 6.48177C13.9115 6.3958 14.009 6.28799 14.0823 6.16458C14.1556 6.04118 14.2034 5.90463 14.2228 5.76288C14.2422 5.62113 14.2328 5.47699 14.1953 5.33882C14.1578 5.20066 14.0928 5.07123 14.0041 4.95804C13.9154 4.84484 13.8048 4.75015 13.6787 4.67945C13.5526 4.60875 13.4136 4.56344 13.2696 4.54617C13.1256 4.5289 12.9796 4.54 12.84 4.57883C12.5628 4.65594 12.3276 4.83761 12.1852 5.08452C12.0429 5.33142 12.0048 5.62369 12.0794 5.89804C12.1539 6.17238 12.3351 6.40673 12.5835 6.55034C12.832 6.69395 13.1279 6.73527 13.407 6.66534ZM14.1627 9.44784C14.3017 9.41115 14.4319 9.34783 14.5461 9.26149C14.6602 9.17515 14.756 9.06749 14.8279 8.94466C14.8999 8.82182 14.9466 8.68621 14.9654 8.54558C14.9842 8.40494 14.9747 8.26203 14.9375 8.125C14.9003 7.98798 14.8361 7.85952 14.7485 7.74696C14.661 7.63441 14.5518 7.53996 14.4272 7.46902C14.3027 7.39807 14.1652 7.35201 14.0226 7.33347C13.88 7.31493 13.7351 7.32428 13.5961 7.36097C13.3155 7.43512 13.0763 7.61616 12.931 7.86428C12.7857 8.11239 12.7464 8.40725 12.8216 8.68399C12.8968 8.96072 13.0803 9.19667 13.3319 9.33992C13.5835 9.48317 13.8821 9.52199 14.1627 9.44784ZM14.9192 12.23C15.0602 12.1951 15.1927 12.133 15.309 12.0471C15.4254 11.9613 15.5233 11.8534 15.5969 11.7299C15.6706 11.6064 15.7186 11.4697 15.7382 11.3277C15.7578 11.1856 15.7485 11.0412 15.7109 10.9028C15.6733 10.7644 15.6081 10.6347 15.5192 10.5213C15.4303 10.408 15.3194 10.3132 15.193 10.2425C15.0666 10.1719 14.9272 10.1267 14.7829 10.1097C14.6386 10.0927 14.4923 10.1042 14.3526 10.1435C14.0762 10.2212 13.8418 10.403 13.7 10.6496C13.5583 10.8962 13.5205 11.1878 13.5949 11.4617C13.6692 11.7355 13.8498 11.9695 14.0975 12.1132C14.3453 12.257 14.6404 12.2989 14.9192 12.23Z" fill="#0096FA"/>
                </svg>
                <span style={{ color: '#000', fontFamily: 'Figtree', fontSize: '16px', fontWeight: 700 }}>Upcoming Events ({events.length})</span>
              </div>
              <div className="space-y-3">
                {events.map((event) => (
                  <div key={event.id} className="p-3" style={{ borderRadius: '6px', border: '0 solid #C5C5C5', background: '#F5F5F5' }}>
                    <div className="flex items-center justify-between mb-2">
                      <h3 style={{ color: '#000', fontFamily: 'Figtree', fontSize: '14px', fontWeight: 700 }}>{event.title}</h3>
                      <span className="px-2 py-0.5" style={{ borderRadius: '5.5px', background: '#A8DCFF', color: '#0096FA', fontFamily: 'Figtree', fontSize: '10px', fontWeight: 700 }}>
                        {formatEventCategory(event.category)}
                      </span>
                    </div>
                    {event.description && (
                      <p className="mb-2" style={{ color: '#000', fontFamily: 'Figtree', fontSize: '12px', fontWeight: 400 }}>
                        {event.description}
                      </p>
                    )}
                    <p style={{ color: '#000', fontFamily: 'Figtree', fontSize: '12px', fontWeight: 400 }}>
                      {new Date(event.startsAt).toLocaleDateString('en-US', {
                        month: 'short',
                        day: 'numeric',
                        hour: 'numeric',
                        minute: '2-digit'
                      })}
                      {' - '}
                      {new Date(event.endsAt).toLocaleDateString('en-US', {
                        month: 'short',
                        day: 'numeric',
                        hour: 'numeric',
                        minute: '2-digit'
                      })}
                    </p>
                    {event.tags && event.tags.length > 0 && (
                      <div className="mt-2 flex flex-wrap gap-1">
                        {event.tags.map((tag, idx) => (
                          <span key={idx} className="px-2 py-0.5" style={{ borderRadius: '5.5px', background: '#EBEBEB', color: '#5E5E5E', fontFamily: 'Figtree', fontSize: '10px', fontWeight: 400 }}>
                            {tag}
                          </span>
                        ))}
                      </div>
                    )}
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* Indoor Map Button (for any location with indoor navigation) */}
          {hasIndoorNav && onOpenIndoorMap && (
            <button
              onClick={(e) => {
                e.stopPropagation();
                onOpenIndoorMap(location.id);
              }}
              className="mt-4 flex w-full items-center justify-center gap-2 rounded-full py-3 font-semibold text-white shadow-lg hover:opacity-90 active:opacity-80 transition-opacity"
              style={{ touchAction: 'manipulation', background: '#0096FA' }}
            >
              <MapPin className="h-5 w-5" />
              Open Indoor Map
            </button>
          )}

          {/* Feedback Section */}
          <div className="mt-4 flex flex-col items-center">
            <h3 style={{ color: '#000', fontFamily: 'Figtree', fontSize: '16px', fontWeight: 700, marginBottom: '12px' }}>
              Help us improve your experience!
            </h3>
            <button
              onClick={(e) => {
                e.stopPropagation();
                setShowFeedback(true);
              }}
              style={{
                touchAction: 'manipulation',
                background: '#0096FA',
                borderRadius: '19px',
                width: '130px',
                height: '32px',
                color: '#FFF',
                fontFamily: 'Figtree',
                fontSize: '14px',
                fontWeight: 500,
                border: 'none',
                cursor: 'pointer',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center'
              }}
            >
              Share Feedback
            </button>
          </div>
          </div>
        </div>
      </div>

      {/* Feedback Overlay */}
      {showFeedback && (
        <FeedbackOverlay
          placeId={location.id}
          placeName={location.name}
          onClose={() => setShowFeedback(false)}
        />
      )}
    </div>
  );
}

